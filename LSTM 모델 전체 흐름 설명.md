# Business-project

# LSTM 모델 전체 흐름 설명

---

## ① LSTM 모델 클래스 정의

- **입력:**  
  여러 시점의 다양한 피처(수위, 유량 등)로 구성된 시계열 시퀀스 데이터 입력

- **LSTM 레이어:**  
  시계열 순서 및 패턴 정보를 자동 학습  
  - 양방향(BiLSTM) 옵션 적용 → 과거→미래와 미래→과거 패턴 모두 반영

- **Fully Connected (FC) 레이어:**  
  - LSTM의 마지막 시점 은닉 상태를 받아 다중 타깃 변수 예측값으로 변환  
  - 배치 정규화(Batch Normalization), ReLU 활성화, 선형 변환 적용으로 안정성과 정확도 향상

---

## ② 학습 함수 (`train_model`)

- **미니배치 학습:**  
  데이터를 여러 배치로 나누어 반복 학습 수행

- **손실 함수:**  
  MSE (Mean Squared Error)를 사용하여 실제값과 예측값 차이를 최소화하는 방향으로 파라미터 갱신

- **검증 데이터 평가:**  
  각 에포크(epoch)마다 검증셋 성능 확인  
  - 타깃별 손실 기록 및 모니터링

- **조기 종료 (Early Stopping):**  
  성능 개선이 없으면 학습 조기 종료하여 과적합 방지

---

## ③ TimeSeriesSplit 기반 그리드 서치 (`grid_search_lstm`)

- **하이퍼파라미터 탐색:**  
  - `hidden_dim`, `num_layers`, `dropout`, `learning_rate`, `seq_length`, `batch_size` 등 다양한 조합 반복 실험

- **시계열 교차검증:**  
  - 여러 시점 구간에 대해 반복적으로 훈련 및 검증 수행  
  - 실제 시계열 데이터 환경과 유사한 모델 평가 가능

- **최적 조합 선정:**  
  - 모든 조합에서 검증 손실이 가장 낮은 모델과 파라미터 기록 및 선택

---

## ④ 전체 워크플로우 핵심 요약

1. **데이터 준비:**  
   - 시계열 구조에 맞춰 입력(X)과 타깃(Y) 분할 및 정규화 수행

2. **모델 설계:**  
   - LSTM + Fully Connected Layer 기반 신경망 구조 정의

3. **학습 및 평가:**  
   - 미니배치 반복 학습  
   - 검증 손실 모니터링  
   - 조기 종료 적용

4. **하이퍼파라미터 튜닝:**  
   - `TimeSeriesSplit` 기반 교차검증으로 과적합 방지 및 최적화

5. **결과:**  
   - 다중 타깃(유출유량, 수위 등) 동시 예측  
   - 실제 환경에 일반화된 신뢰성 높은 예측 성능 확보
