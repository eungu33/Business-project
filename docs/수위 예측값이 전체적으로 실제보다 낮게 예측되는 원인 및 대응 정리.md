# 수위 예측값의 고정적 편향 현상 및 대응 요약

---

## 문제 현상

- `D_배수지_수위7_m3`, `D_배수지_수위8_m3` 타겟에서 예측값이 실제값보다 약 **100㎥ 낮게** 예측되는 현상 발생  
- 전체 시계열 추세는 유사하나, 예측값이 항상 아래쪽으로 평행 이동한 형태를 보임  
- 특정 구간이 아닌 **Validation, Test 전 구간에서 동일한 패턴 반복**

---

## 주요 원인 분석

### 1. 예측값에 포함된 고정적 편향(Bias)

- 모델은 전체적인 수위 추세를 안정적으로 학습했으나,  
- 출력값 자체가 일정 수준 **낮게 형성**됨  
- 이는 손실 함수(MSE)의 평균 중심적 특성과 정규화 방식에서 기인

### 2. MinMax 정규화의 한계

- `MinMaxScaler`는 Train 데이터 내 **최대값 기준**으로 0~1 사이 값으로 압축  
- 예를 들어 Train 최대 수위가 5800㎥일 때,  
  - 5900㎥에 가까운 실제 고수위 값은 학습 시 거의 나타나지 않음  
  - 모델은 이 값을 학습 과정에서 낮게 예측하는 방향으로 손실을 최소화함 → 편향 발생

---

## 대응 방안: 정규화 방식 변경

| 구분            | 내용                                  |
|-----------------|-------------------------------------|
| 기존 방식       | **MinMaxScaler** (Train 데이터 기준)  |
| 문제점          | Test 데이터에 Train보다 큰 값 포함 시 모델 표현 한계 발생 |
| 대안            | **StandardScaler** (평균 0, 표준편차 1) 적용  |
| 기대 효과       | - 분포 중심 이동 유연 반영<br>- 평균 중심 편향 완화<br>- 음수 및 양수 값 모두 표현 가능 → 안정적 수위 예측 |

---

## 모델 성능 및 과적합 평가

### 1. 성능 지표 (R² 기준)

| 타겟           | Train R² | Validation R² | Test R² |
|----------------|----------|---------------|---------|
| 유출유량2      | 0.9499   | 0.9396        | 0.9306  |
| 수위7 (m³)     | 0.9966   | 0.9931        | 0.9895  |
| 수위8 (m³)     | 0.9972   | 0.9941        | 0.9920  |

- Train, Validation, Test 간 큰 성능 격차 없이 고성능 유지

### 2. Train vs Validation Loss 특이 현상

- 일부 구간에서 **Validation Loss가 Train Loss보다 낮음**  
- 원인으로 추정되는 두 가지 요인:
  1. **Dropout(0.2) 효과**  
     - 학습 시 일부 뉴런 비활성화 → Train Loss 상승  
     - 검증 시 Dropout 미적용 → 전체 네트워크 사용, Loss 감소 가능
  2. **데이터 구간 특성**  
     - Validation 구간이 비교적 단순, 안정적인 흐름  
     - 학습 구간보다 예측이 상대적으로 용이해 Loss 낮게 측정

---

## 예측 성능 향상 요인

- 배수지 시스템의 물리적 특성: 변화가 느리고 이전 상태가 다음 상태에 큰 영향  
- 2시간(24개 시점) 시퀀스 길이가 충분히 맥락 포착  
- lag, diff, rolling 등 다양한 시계열 파생 피처 활용  
- Multi-output LSTM 구조로 상호 관련성 학습, 수위와 유출유량 동시 예측  
- 타겟 변수 과거 시점 정보 활용으로 성능 극대화

---

## 결론 및 추가 검토 사항

- 예측 성능과 지표가 매우 우수하지만,  
- Validation Loss가 Train Loss보다 낮은 현상은 Dropout 효과 및 데이터 특성에 기인한 것으로 보임  
- 이를 단순 과적합으로 단정하기보다는 모델 구조와 데이터 특성에 따른 정상 범위 현상으로도 해석 가능  
- 필요시 추가 검증(예: 다른 검증 데이터셋, 교차검증)으로 과적합 여부 정밀 판단 권장
