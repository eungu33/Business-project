# 정보 누수 여부 및 예측 패턴 분석

## 피처 생성 시 정보 누수 여부 확인

아래는 사용한 주요 파생 피처들과 그에 대한 정보 누수(데이터 누설) 가능성 여부입니다.

| Feature 유형        | 생성 함수              | 원리 설명                                            | 정보 누수 |
|---------------------|------------------------|-------------------------------------------------------|-----------|
| Lag Feature         | `add_lag_features`     | 과거 시점의 값을 현재 시점에 복사 (`shift(lag)`)      | ❌ 없음    |
| Diff Feature        | `add_diff_features`    | 현재 - 과거 시점 값 (`diff(period)`)                  | ❌ 없음    |
| Pct Change Feature  | `add_pct_change_features` | 과거 대비 변화율 (`pct_change(period)`)           | ❌ 없음    |
| Rolling Feature     | `add_rolling_features` | 과거 구간 평균/표준편차 (`rolling(window).mean/std`) | ❌ 없음    |

**주의**  
- `shift(-1)`처럼 미래 시점을 참조하는 방식은 정보 누수 발생 가능 (사용하지 않음)
- Pandas의 `shift`, `diff`, `rolling` 등은 기본적으로 과거 기준이므로 누수 X

---

## 📊 컬럼 그룹별 피처 전략

| 컬럼 그룹      | Lag | Diff | Pct Change | Rolling Mean | Rolling Std | 설명 |
|----------------|-----|------|------------|---------------|--------------|------|
| 수위 (Level)   | ✅  | ✅   | ❌         | ✅            | ✅           | 시계열적 변화 반영 필요, 안정성/변동성 중요 |
| 개도율 (Valve) | ✅  | ✅   | ❌         | ✅            | ❌           | 제어 신호 특성상 비율 변화 해석 불가능 |
| 유입유량 (Inflow) | ✅  | ✅   | ✅         | ✅            | ❌           | 사고 감지 및 점진적 변화 인식 필요 |
| 기온/강수량 (Weather) | ✅  | ❌   | ❌         | ✅ (중심)     | ✅           | 환경 요인 → 일간/주간 패턴 중요 |

---

## “예측값이 실제값을 그대로 따라가는 이유” 분석

### 1. 데이터 패턴이 단순하고 반복적임
- 배수지 수위/유출유량은 하루/주 단위로 반복되는 패턴이 존재
- 계절적 변동이 적은 **가을~겨울** 시기 데이터 사용

### 2. 고도화된 전처리 및 피처 엔지니어링
- 결측치, 이상치 처리 및 파생 피처 생성이 적절하게 수행됨
- 노이즈가 줄고 모델이 본질적인 패턴 학습에 집중 가능

### 3. 검증/테스트 구간이 학습 데이터와 유사
- **TimeSeriesSplit**으로 순서를 유지한 교차검증 수행
- 큰 외부 환경 변화 없이 패턴이 유사하게 유지됨

### 4. LSTM의 구조적 강점
- 과거 순서 정보 및 패턴 학습에 특화
- 적은 양의 데이터로도 높은 예측 성능 달성 가능

---

## 정리

- 모든 피처는 **과거 데이터만을 사용**하여 생성 → 정보 누수 없음
- **시계열 구조, 반복성, 안정성**이 뚜렷한 데이터 특성 덕분에 예측 성능 높음
- LSTM 모델은 이러한 환경에서 **최적의 선택**이었음

